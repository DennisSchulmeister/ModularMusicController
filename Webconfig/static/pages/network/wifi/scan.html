<div
    x-data="{
        api: new APIClient({errorHandler: APIClient.alertErrorHandler}),
        results: [],
        confirm: function(ssid) {
            $store.popup.obj.setResult(ssid);
            $store.popup.obj.close();
        },
    }"
    x-init="
        $store.popup.obj.onClose(() => api.abort());
        results = await api.postFunction('wifi-scan');
    "
>
    <div class="fs-4 text-center" x-show="!results.length">
        Scanning â€¦
    </div>

    <p class="fw-light fst-italic" x-show="results.length">
        Please select the WiFi network below.
    </p>

    <div class="table-responsive">
        <table class="table table-striped" x-show="results.length">
            <thead>
                <tr>
                    <th scope="col">Network Name (SSID)</th>
                    <th scope="col">Type</th>
                    <th scope="col" class="text-end">Strength</th>
                </tr>
            </thead>
            <tbody>
                <template x-for="result in results" :key="result.ssid">
                    <tr>
                        <td>
                            <a href="#" x-text="result.ssid" @click.prevent="confirm(result.ssid)"></a>
                        </td>
                        <td>
                            <span x-show="result.type === 'open'">Open</span>
                            <span x-show="result.type === 'wpa'">Pre-Shared Key</span>
                            <span x-show="result.type === 'enterprise'">Enterprise</span>
                        </td>
                        <td x-text="result.strength" class="text-end"></td>
                    </tr>
                </template>
            </tbody>
        </table>
    </div>
</div>